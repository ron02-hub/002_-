# 擬似データ生成スクリプト

## 概要

このスクリプトは、アンケートシステムの検証用に200名分の擬似データを生成します。

## 生成されるデータ

- **回答者（Respondent）**: 200名
  - 年齢グループ、性別、都道府県、運転歴、EV所有経験、音への感度等
- **評価データ（Evaluation）**: 1,200件（200名 × 6音声サンプル）
  - SD法スコア（9軸）
  - 購買意欲（1-7段階）
  - 前提条件情報（Honda N-Box, 200万円等）
  - 自由記述（一部）
- **最良・最悪比較（BestWorstComparison）**: 200件
  - 最良音・最悪音の選択
  - 理由の記述
- **コンストラクト（Construct）**: 200件
  - ラダリング情報（上位・下位概念）含む
- **インタビューログ（InterviewLog）**: 約800件
  - 各回答者あたり3-5件のインタビュー回答

## 使用方法

### 1. 前提条件の確認

```bash
cd src

# データベースマイグレーションが完了していること
npm run db:migrate

# シードデータ（音声サンプル）が投入されていること
npm run db:seed
```

### 2. 擬似データの生成

```bash
# 200名分のデータを生成（デフォルト）
npm run db:mock:200

# または、任意の人数を指定
npm run db:mock 100  # 100名分
npm run db:mock 500  # 500名分
```

### 3. データの確認

```bash
# Prisma Studioでデータを確認
npm run db:studio
```

## データの特徴

### 分布の設計

- **年齢グループ**: 均等分布
- **性別**: 均等分布
- **都道府県**: 主要都道府県に偏り（80%が主要都道府県）
- **購買意欲**: 正規分布に近い分布（中央値4に近い値を生成しやすく）
- **SD法スコア**: -3から+3の範囲でランダム分布
- **EV所有経験**: 20%がEV所有

### データの整合性

- 最良・最悪音が異なる音声であることを保証
- 全音声サンプルに対して評価データが存在
- 前提条件情報が正しく保存

## トラブルシューティング

### エラー: 音声サンプルが不足しています

```bash
# シードデータを再投入
npm run db:seed
```

### エラー: データベース接続エラー

`.env.local`ファイルの`DATABASE_URL`が正しく設定されているか確認してください。

### 既存データを削除して再生成

```bash
# データベースをリセット（開発環境のみ）
npx prisma migrate reset
npm run db:seed
npm run db:mock:200
```

## 検証項目

生成されたデータで以下の検証を実施：

1. **データ整合性チェック**
   - 最良・最悪音が異なること
   - 評価データが全音声サンプルに対して存在すること

2. **統計分析の可能性**
   - 因子分析が実行可能なサンプルサイズ
   - クロス集計が可能なデータ量
   - 相関分析が実行可能

3. **データ分布の確認**
   - 年齢、性別の分布
   - 購買意欲の分布
   - SD法スコアの分布

